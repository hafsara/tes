<app-navbar
  (appOptionsLoaded)="appOptions = $event"
  (selectedAppIdsChange)="onSelectedAppIdsChange($event)">
</app-navbar>

<div class="layout">
  <app-sidebar
    (menuItemSelected)="handleStatusChange($event)"
    (createFormClicked)="navigateToCreateForm()">
  </app-sidebar>

  <div class="content-container" [ngSwitch]="currentView">
    <app-dashboard-table
      *ngSwitchCase="'table'"
      [forms]="(state.forms$ | async) ?? []"
      [totalCount]="(state.totalCount$ | async) ?? 0"
      [currentPage]="state.currentPage$.value"
      [pageSize]="state.pageSize$.value"
      [isFilterVisible]="isFilterVisible"
      (pageChanged)="state.updatePagination($event.page, $event.limit)"
      (sortChanged)="state.updateSort($event)"
      (filterToggled)="isFilterVisible = !isFilterVisible"
      (formSelected)="onFormSelected($event)"
      (filterChanged)="state.updateFilters($event)">
    </app-dashboard-table>

    <div *ngSwitchCase="'questions'">
      <p-button icon="pi pi-chevron-left" (click)="showTableView()"></p-button>
      <app-form-container-preview *ngIf="accessToken" [accessToken]="accessToken"></app-form-container-preview>
    </div>

    <div *ngSwitchCase="'createForm'">
      <p-button icon="pi pi-chevron-left" (click)="showTableView()"></p-button>
      <app-create-form-container [appOptions]="appOptions"></app-create-form-container>
    </div>

    <div *ngSwitchCase="'loading'">
      <div class="card flex justify-content-center">
        <p-progressSpinner ariaLabel="loading"></p-progressSpinner>
      </div>
    </div>
  </div>
</div>
